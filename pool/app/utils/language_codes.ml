(* https://gist.github.com/glumb/623cf25d1a9ef5d8b6c090f2030195a6 *)

let language_codes =
  [ "af", "AF"
  ; "sq", "SQ"
  ; "ar", "AR"
  ; "ar-dz", "AR"
  ; "ar-bh", "AR"
  ; "ar-eg", "AR"
  ; "ar-iq", "AR"
  ; "ar-jo", "AR"
  ; "ar-kw", "AR"
  ; "ar-lb", "AR"
  ; "ar-ly", "AR"
  ; "ar-ma", "AR"
  ; "ar-om", "AR"
  ; "ar-qa", "AR"
  ; "ar-sa", "AR"
  ; "ar-sy", "AR"
  ; "ar-tn", "AR"
  ; "ar-ae", "AR"
  ; "ar-ye", "AR"
  ; "an", "AN"
  ; "hy", "HY"
  ; "as", "AS"
  ; "ast", "AST"
  ; "az", "AZ"
  ; "eu", "EU"
  ; "bg", "BG"
  ; "be", "BE"
  ; "bn", "BN"
  ; "bs", "BS"
  ; "br", "BR"
  ; "my", "MY"
  ; "ca", "CA"
  ; "ch", "CH"
  ; "ce", "CE"
  ; "zh", "ZH"
  ; "zh-hk", "ZH"
  ; "zh-cn", "ZH"
  ; "zh-sg", "ZH"
  ; "zh-tw", "ZH"
  ; "cv", "CV"
  ; "co", "CO"
  ; "cr", "CR"
  ; "hr", "HR"
  ; "cs", "CS"
  ; "da", "DA"
  ; "nl", "NL"
  ; "nl-be", "NL"
  ; "en", "EN"
  ; "en-au", "EN"
  ; "en-bz", "EN"
  ; "en-ca", "EN"
  ; "en-ie", "EN"
  ; "en-jm", "EN"
  ; "en-nz", "EN"
  ; "en-ph", "EN"
  ; "en-za", "EN"
  ; "en-tt", "EN"
  ; "en-gb", "EN"
  ; "en-us", "EN"
  ; "en-zw", "EN"
  ; "eo", "EO"
  ; "et", "ET"
  ; "fo", "FO"
  ; "fj", "FJ"
  ; "fi", "FI"
  ; "fr", "FR"
  ; "fr-be", "FR"
  ; "fr-ca", "FR"
  ; "fr-fr", "FR"
  ; "fr-lu", "FR"
  ; "fr-mc", "FR"
  ; "fr-ch", "FR"
  ; "fy", "FY"
  ; "fur", "FUR"
  ; "gd-ie", "GD"
  ; "gl", "GL"
  ; "ka", "KA"
  ; "de", "DE"
  ; "de-at", "DE"
  ; "de-de", "DE"
  ; "de-li", "DE"
  ; "de-lu", "DE"
  ; "de-ch", "DE"
  ; "el", "EL"
  ; "gu", "GU"
  ; "ht", "HT"
  ; "he", "HE"
  ; "hi", "HI"
  ; "hu", "HU"
  ; "is", "IS"
  ; "id", "ID"
  ; "iu", "IU"
  ; "ga", "GA"
  ; "it", "IT"
  ; "it-ch", "IT"
  ; "ja", "JA"
  ; "kn", "KN"
  ; "ks", "KS"
  ; "kk", "KK"
  ; "km", "KM"
  ; "ky", "KY"
  ; "tlh", "TLH"
  ; "ko", "KO"
  ; "ko-kp", "KO"
  ; "ko-kr", "KO"
  ; "la", "LA"
  ; "lv", "LV"
  ; "lt", "LT"
  ; "lb", "LB"
  ; "mk", "MK"
  ; "ms", "MS"
  ; "ml", "ML"
  ; "mt", "MT"
  ; "mi", "MI"
  ; "mr", "MR"
  ; "mo", "MO"
  ; "nv", "NV"
  ; "ng", "NG"
  ; "ne", "NE"
  ; "no", "NO"
  ; "nb", "NB"
  ; "nn", "NN"
  ; "oc", "OC"
  ; "or", "OR"
  ; "om", "OM"
  ; "fa", "FA"
  ; "fa-ir", "FA"
  ; "pl", "PL"
  ; "pt", "PT"
  ; "pt-br", "PT"
  ; "pa", "PA"
  ; "pa-in", "PA"
  ; "pa-pk", "PA"
  ; "qu", "QU"
  ; "rm", "RM"
  ; "ro", "RO"
  ; "ro-mo", "RO"
  ; "ru", "RU"
  ; "ru-mo", "RU"
  ; "sz", "SZ"
  ; "sg", "SG"
  ; "sa", "SA"
  ; "sc", "SC"
  ; "gd", "GD"
  ; "sd", "SD"
  ; "si", "SI"
  ; "sr", "SR"
  ; "sk", "SK"
  ; "sl", "SL"
  ; "so", "SO"
  ; "sb", "SB"
  ; "es", "ES"
  ; "es-ar", "ES"
  ; "es-bo", "ES"
  ; "es-cl", "ES"
  ; "es-co", "ES"
  ; "es-cr", "ES"
  ; "es-do", "ES"
  ; "es-ec", "ES"
  ; "es-sv", "ES"
  ; "es-gt", "ES"
  ; "es-hn", "ES"
  ; "es-mx", "ES"
  ; "es-ni", "ES"
  ; "es-pa", "ES"
  ; "es-py", "ES"
  ; "es-pe", "ES"
  ; "es-pr", "ES"
  ; "es-es", "ES"
  ; "es-uy", "ES"
  ; "es-ve", "ES"
  ; "sx", "SX"
  ; "sw", "SW"
  ; "sv", "SV"
  ; "sv-fi", "SV"
  ; "sv-sv", "SV"
  ; "ta", "TA"
  ; "tt", "TT"
  ; "te", "TE"
  ; "th", "TH"
  ; "tig", "TIG"
  ; "ts", "TS"
  ; "tn", "TN"
  ; "tr", "TR"
  ; "tk", "TK"
  ; "uk", "UK"
  ; "hsb", "HSB"
  ; "ur", "UR"
  ; "ve", "VE"
  ; "vi", "VI"
  ; "vo", "VO"
  ; "wa", "WA"
  ; "cy", "CY"
  ; "xh", "XH"
  ; "ji", "JI"
  ; "zu", "ZU"
  ]
;;

let find l =
  l
  |> CCString.lowercase_ascii
  |> CCFun.flip (CCList.assoc_opt ~eq:CCString.equal) language_codes
;;
